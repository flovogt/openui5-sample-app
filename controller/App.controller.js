jQuery.sap.declare("sap.ui.demo.todo.controller.App");jQuery.sap.require("sap.ui.Device");jQuery.sap.require("sap.ui.core.mvc.Controller");jQuery.sap.require("sap.ui.model.Filter");jQuery.sap.require("sap.ui.model.FilterOperator");jQuery.sap.require("sap.ui.model.json.JSONModel");jQuery.sap.require("sap.ui.core.BarColor");jQuery.sap.require("sap.ui.demo.todo.util.Helper");sap.ui.controller("sap.ui.demo.todo.controller.App",{onInit(){this.aSearchFilters=[];this.aTabFilters=[];this.BarColor=sap.ui.core.BarColor;this.getView().setModel(new sap.ui.model.json.JSONModel({isMobile:sap.ui.Device.browser.mobile}),"view")},onAfterRendering(){const e=jQuery("#container-todo---app--avatar-profile");const t=e.control(0);t.setSrc(sap.ui.demo.todo.util.Helper.resolvePath("./img/logo_ui5.png"));sap.ui.require(["sap/m/Button"],e=>{const t=new e({id:"clearCompletedB",enabled:"{/itemsRemovable}",icon:"sap-icon://delete",text:"{i18n>CLEAR_COMPLETED}",tap:this.onClearCompleted.bind(this)});this.byId("toolbar").addContent(t)})},getModel(){return this.getView().getModel()},addTodo(){const e=this.getModel();const t=this.getTodos().map(e=>Object.assign({},e));t.push({title:e.getProperty("/newTodo"),completed:false});e.setProperty("/todos",t);e.setProperty("/newTodo","")},onClearCompleted(){const e=this.getTodos().map(e=>Object.assign({},e));this.removeCompletedTodos(e);this.getModel().setProperty("/todos",e)},removeCompletedTodos(e){let t=e.length;while(t--){const r=e[t];if(r.completed){e.splice(t,1)}}},getTodos(){const e=this.getModel();return e&&e.getProperty("/todos")||[]},onUpdateItemsLeftCount(){const e=this.getTodos().filter(e=>e.completed!==true).length;this.getModel().setProperty("/itemsLeftCount",e)},onSearch(e){const t=this.getModel();this.aSearchFilters=[];this.sSearchQuery=e.getSource().getValue();if(this.sSearchQuery&&this.sSearchQuery.length>0){t.setProperty("/itemsRemovable",false);const e=new Filter("title",FilterOperator.Contains,this.sSearchQuery);this.aSearchFilters.push(e)}else{t.setProperty("/itemsRemovable",true)}this._applyListFilters()},onFilter(e){this.aTabFilters=[];this.sFilterKey=e.getParameter("item").getKey();switch(this.sFilterKey){case"active":this.aTabFilters.push(new Filter("completed",FilterOperator.EQ,false));break;case"completed":this.aTabFilters.push(new Filter("completed",FilterOperator.EQ,true));break;case"all":default:}this._applyListFilters()},_applyListFilters(){const e=sap.ui.getCore().byId("container-todo---app--todoList");const t=e.getBinding("items");t.filter(this.aSearchFilters.concat(this.aTabFilters),"todos");const r=this.getI18NKey(this.sFilterKey,this.sSearchQuery);this.byId("filterToolbar").setVisible(!!r);if(r){this.byId("filterLabel").bindProperty("text",{path:r,model:"i18n",formatter:e=>formatMessage(e,[this.sSearchQuery])})}},getI18NKey(e,t){if(!e||e==="all"){return t?"ITEMS_CONTAINING":undefined}else if(e==="active"){return"ACTIVE_ITEMS"+(t?"_CONTAINING":"")}else{return"COMPLETED_ITEMS"+(t?"_CONTAINING":"")}}});
//# sourceMappingURL=App.controller.js.map