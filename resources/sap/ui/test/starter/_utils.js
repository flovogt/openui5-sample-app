/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/isPlainObject","sap/base/util/merge","./config"],function(e,t,n){"use strict";function r(e){var t=document.querySelector("["+e+"]");return t?t.getAttribute(e):null}function s(){var e=sap.ui.loader._.guessResourceName(window.location.href);if(e==null&&window.location.pathname.startsWith("/base/test/")){const t=window.location.origin+window.location.pathname.replace("/base/test/","/base/test-resources/");e=sap.ui.loader._.guessResourceName(t)}return e?e.replace(/\.html$/,""):null}function o(){return new Promise(function(e){function t(){document.removeEventListener("DOMContentLoaded",t,false);e()}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",t,false)}else{e()}})}function i(e){var t=document.createElement("link");t.rel="stylesheet";t.href=sap.ui.require.toUrl(e);document.head.appendChild(t)}function u(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")}const[a,c]=(()=>{const e=new URL(document.baseURI);return[e.origin,e.origin+e.pathname]})();function l(e,t,n){if(e.startsWith("ui5:")){if(!e.startsWith("ui5://")){throw new TypeError(`Test '${n}': Page URLs using the 'ui5' protocol must be absolute. Relative and server absolute URLs are reserved for future use.`)}const t=e.slice(6);e=sap.ui.require.toUrl(t)}else{e=sap.ui.require.toUrl("")+"/../"+e}const r=new URL(e,c);if(t!=null){if(typeof t!=="object"){throw new TypeError(`Test '${n}': URL parameters must be an object.`)}const e=r.searchParams;for(const n in t){if(Object.hasOwn(t,n)){const r=t[n];if(Array.isArray(r)){r.forEach(t=>e.append(n,t))}else{e.append(n,r)}}}}return r.origin===a?r.pathname+r.search+r.hash:r.href}function f(e){if(e&&typeof e==="object"){if(e.qunit===null||e.qunit===false){e.qunit={version:null}}else if(typeof e.qunit==="number"||e.qunit==="edge"){e.qunit={version:e.qunit}}else if(typeof e.qunit!=="object"){e.qunit={}}if(e.sinon===null||e.sinon===false){e.sinon={version:null}}else if(typeof e.sinon==="number"||e.sinon==="edge"){e.sinon={version:e.sinon}}else if(typeof e.sinon!=="object"){e.sinon={}}}else{e=null}return e}function p(r,s){function o(e,t){return e==null?e:e.replace(/\{suite\}/g,s).replace(/\{name\}/g,t)}var i=s.slice(0,s.lastIndexOf("/")+1);function u(e){return e==null?e:e.replace(/^\.\//,i)}var a=t({},n,f(r.defaults));Object.keys(r.tests).forEach(function(n){var s=f(r.tests[n]),i={name:n};const c=(...n)=>{const r=t({},n.shift());while(n.length){const t=n.shift();for(const n in t){r[n]=e(r[n])?c(r[n],t[n]):t[n]}}return r};s=c(a,i,s);if(Array.isArray(s.module)){s.module=s.module.map(function(e){return u(o(e,n))})}else{s.module=u(o(s.module,n))}s.beforeBootstrap=u(o(s.beforeBootstrap,n));s.page=l(o(s.page,n),s.searchParams||s.uriParams,n);s.title=o(s.title,n);r.tests[n]=s});r.sortedTests=Object.keys(r.tests).sort(function(e,t){var n=r.tests[e].group||"";var s=r.tests[t].group||"";if(n!==s){return n<s?-1:1}e=e.toUpperCase();t=t.toUpperCase();if(e===t){return 0}return e<t?-1:1}).map(function(e){return r.tests[e]});return r}var d=/^test-resources\/([a-zA-Z_$\-][a-zA-Z_$0-9\-\.]*\/)*testsuite(?:\.[a-z][a-z0-9\-]*)*\.qunit$/;function m(e){return new Promise(function(t,n){if(!e){throw new TypeError("No test suite specified")}if(!d.test(e)){throw new TypeError("Invalid test suite name")}sap.ui.require([e],function(r){try{t(p(r,e))}catch(e){n(e)}},function(e){n(e)})})}function h(e){const t=r("data-sap-ui-resource-roots");if(!t){return}const n=JSON.parse(t);const s={};for(const e in n){s[e.replace(/\./g,"/")]=n[e]||"."}sap.ui.loader.config({paths:s})}sap.ui.loader.config({paths:{"test-resources":sap.ui.require.toUrl("")+"/../test-resources/"}});return{defaultConfig:n,addStylesheet:i,encode:u,getAttribute:r,getDefaultSuiteName:s,getSuiteConfig:m,whenDOMReady:o,registerResourceRoots:h}});
//# sourceMappingURL=_utils.js.map