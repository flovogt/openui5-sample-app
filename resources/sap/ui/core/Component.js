/*
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Manifest","./ComponentHooks","./ComponentMetadata","./ElementRegistry","sap/base/config","sap/base/future","sap/base/i18n/Localization","sap/base/util/extend","sap/base/util/deepExtend","sap/base/util/merge","sap/ui/base/ManagedObject","sap/ui/base/OwnStatics","sap/ui/core/Lib","sap/ui/core/ResizeHandler","sap/ui/performance/trace/Interaction","sap/ui/util/_enforceNoReturnValue","sap/ui/util/_URL","sap/base/assert","sap/base/Log","sap/base/util/Deferred","sap/base/util/ObjectPath","sap/base/util/isPlainObject","sap/base/util/LoaderExtensions","sap/base/strings/camelize","sap/ui/core/_UrlResolver","sap/ui/VersionInfo","sap/ui/core/ComponentRegistry","sap/ui/core/util/_LocalizationHelper"],function(e,t,n,o,i,a,r,s,c,u,f,p,d,l,m,g,h,v,y,M,b,_,w,C,S,O,E,A){"use strict";const{runWithOwner:T,getCurrentOwnerId:P}=p.get(f);var U={lazy:"lazy",eager:"eager",waitFor:"waitFor"};function I(e){return{name:e,type:i.Type.String,external:true}}function j(e){["sap-client","sap-server"].forEach(function(t){if(!e.searchParams.has(t)){var n=i.get(I(C(t)));if(n){e.searchParams.set(t,n)}}})}function x(e,t,n,o){if(n){for(var i in e){if(!t[i]&&n[i]&&n[i].uri){t[i]=o}}}}function D(e,t,o,i){var a=t.getEntry(o);if(a!==undefined&&!_(a)){return a}var r,s;if(i&&(r=e.getParent())instanceof n){s=r._getManifestEntry(o,i)}if(s||a){a=c({},s,a)}return a}function N(e,t){var n=Object.create(Object.getPrototypeOf(e));n._oMetadata=e;n._oManifest=t;for(var o in e){if(!/^(getManifest|_getManifest|getManifestObject|getManifestEntry|_getManifestEntry|getMetadataVersion)$/.test(o)&&typeof e[o]==="function"){n[o]=e[o].bind(e)}}n.getManifest=function(){return this._getManifest()};n.getManifestEntry=function(e,t){return this._getManifestEntry(e,t)};n._getManifest=function(){return t&&t.getJson()};n.getManifestObject=function(){return t};n._getManifestEntry=function(n,o){return D(e,t,n,o)};n.getMetadataVersion=function(){return 2};n.collectRoutingClasses=e.collectRoutingClasses;n[Symbol("isProxy")]=true;return n}let k;const R=()=>{k??=new Promise((e,t)=>{sap.ui.require(["sap/ui/core/_CommandPool"],e,t)});return k};const B=async e=>{if(e?.getEntry("/sap.ui5/commands")){const t=await R();t.resolve(e)}};const F=e=>{if(e?.getEntry("/sap.ui5/commands")){const t=sap.ui.requireSync("sap/ui/core/_CommandPool");t.resolve(e)}};var $=f.extend("sap.ui.core.Component",{constructor:function(e,t){var n=Array.prototype.slice.call(arguments);if(typeof e!=="string"){t=e;e=undefined}if(t&&typeof t._metadataProxy==="object"){this._oMetadataProxy=t._metadataProxy;this._oManifest=t._metadataProxy._oManifest;delete t._metadataProxy;this.getMetadata=function(){return this._oMetadataProxy}}if(t&&typeof t._cacheTokens==="object"){this._mCacheTokens=t._cacheTokens;delete t._cacheTokens}if(t&&Array.isArray(t._activeTerminologies)){this._aActiveTerminologies=t._activeTerminologies;delete t._activeTerminologies}if(t&&typeof t._componentConfig==="object"){this._componentConfig=t._componentConfig;delete t._componentConfig}(()=>{this._bSyncCreation=t?._syncCreation??true;delete t?._syncCreation})();if(t&&typeof t._manifestModels==="object"){this._mManifestModels=t._manifestModels;delete t._manifestModels}else{this._mManifestModels={}}this._mServices={};this._oKeepAliveConfig=this.getManifestEntry("/sap.ui5/keepAlive");if(this._oKeepAliveConfig){this._oKeepAliveConfig.supported=!!this._oKeepAliveConfig.supported}this._bIsActive=true;this._aDestroyables=[];f.apply(this,n)},metadata:{stereotype:"component",abstract:true,specialSettings:{componentData:"any"},version:"0.0",includes:[],dependencies:{libs:[],components:[],ui5version:""},config:{},customizing:{},library:"sap.ui.core"}},n);E.init($);function H(e,t){o.forEach(function(n,o){var i=$.getOwnerIdFor(n);if(i===t&&!n.getParent()){e(n,o)}})}function L(e){var t,n;if(i.get({name:"sapUiXxDisableCustomizing",type:i.Type.Boolean})){return t}if(typeof e==="string"){n=e}else if(e&&typeof e.isA==="function"&&!e.isA("sap.ui.core.Component")){n=$.getOwnerIdFor(e)}else{t=e}if(n){t=$.getComponentById(n)}if(t){if(t.getExtensionComponent){t=t.getExtensionComponent();if(!t){throw new Error("getExtensionComponent() must return an instance.")}}}return t}$.getCustomizing=function(e,t){var n=t.type,o=t.name?"/"+t.name:"",i="/sap.ui5/extends/extensions/"+n+o;if(n==="sap.ui.viewExtensions"){i+="/"+t.extensionName}var a=L(e);return a?a._getManifestEntry(i,true):undefined};$.getComponentPreloadMode=function(){return i.get({name:"sapUiXxComponentPreload",type:i.Type.String,external:true})||d.getPreloadMode()};$.prototype.getManifest=function(){if(!this._oManifest){return this.getMetadata()._getManifest()}else{return this._oManifest.getJson()}};$.prototype.getManifestEntry=function(e){return this._getManifestEntry(e)};$.prototype._getManifestEntry=function(e,t){if(!this._oManifest){return this.getMetadata()._getManifestEntry(e,t)}else{return D(this.getMetadata(),this._oManifest,e,t)}};$.prototype.getManifestObject=function(){if(!this._oManifest){return this.getMetadata().getManifestObject()}else{return this._oManifest}};$.prototype._isVariant=function(){if(this._oManifest){var e=this.getManifestEntry("/sap.ui5/componentName");return e&&e!==this.getManifestEntry("/sap.app/id")}else{return false}};$.activateCustomizing=function(e){};$.deactivateCustomizing=function(e){};$.getOwnerIdFor=function(e){v(e instanceof f,"oObject must be given and must be a ManagedObject");var t=e instanceof f&&e._sOwnerId;return t||undefined};$.getOwnerComponentFor=function(e){return $.getComponentById($.getOwnerIdFor(e))};$.prototype.runAsOwner=function(e){if(!this.isActive()){throw new Error("Execute 'runAsOwner' on an inactive owner component is not supported. Component: '"+this.getMetadata().getName()+"' with id '"+this.getId()+"'.")}return T(e,this.getId())};$.prototype.getInterface=function(){return this};$.prototype._initCompositeSupport=function(e){this.oComponentData=e&&e.componentData;if(this._oManifest){this._oManifest.init(this)}else{this.getMetadata().init()}if(this._isVariant()){var t=this._oManifest.getEntry("/sap.app/id");if(t){Y(t,this._oManifest.resolveUri("./","manifest"))}}this.initComponentModels();(()=>{if(this.onWindowError){this._fnWindowErrorHandler=function(e){var t=e.originalEvent;this.onWindowError(t.message,t.filename,t.lineno)}.bind(this);window.addEventListener("error",this._fnWindowErrorHandler)}if(this.onWindowBeforeUnload){this._fnWindowBeforeUnloadHandler=function(e){var t=this.onWindowBeforeUnload.apply(this,arguments);if(typeof t==="string"){e.returnValue=t;e.preventDefault();return t}}.bind(this);window.addEventListener("beforeunload",this._fnWindowBeforeUnloadHandler)}if(this.onWindowUnload){this._fnWindowUnloadHandler=this.onWindowUnload.bind(this);window.addEventListener("unload",this._fnWindowUnloadHandler)}})()};$.prototype._getDestroyables=function(){if(!this._aDestroyables){a.errorThrows(`${this.getManifestObject().getComponentName()}: A sub-class of sap.ui.core.Component which overrides the constructor must apply the super constructor as well.`,null,"sap.ui.support",function(){return{type:"missingSuperConstructor"}});this._aDestroyables=[]}return this._aDestroyables};$.prototype.destroy=function(){var e,t=false;for(var n in this._mServices){if(this._mServices[n].instance){this._mServices[n].instance.destroy()}}delete this._mServices;for(var o in this._mManifestModels){this._mManifestModels[o].destroy()}delete this._mManifestModels;(()=>{if(this._fnWindowErrorHandler){window.removeEventListener("error",this._fnWindowErrorHandler);delete this._fnWindowErrorHandler}if(this._fnWindowBeforeUnloadHandler){window.removeEventListener("beforeunload",this._fnWindowBeforeUnloadHandler);delete this._fnWindowBeforeUnloadHandler}if(this._fnWindowUnloadHandler){window.removeEventListener("unload",this._fnWindowUnloadHandler);delete this._fnWindowUnloadHandler}})();if(this._oEventBus){this._oEventBus.destroy();delete this._oEventBus}function i(e){if(e&&!e._bIsBeingDestroyed){e.destroy()}}function a(e){t=true}var r=this._getDestroyables();for(var s=0;s<r.length;s++){r[s]=r[s].then(i,a)}if(r.length>0){e=Promise.all(r).then(function(){if(t){H(function(e){e.destroy()},this.getId())}}.bind(this))}f.prototype.destroy.apply(this,arguments);const c=sap.ui.require("sap/ui/core/Messaging");c?.unregisterObject(this);if(this._oManifest){this._oManifest.exit(this);delete this._oManifest}else{this.getMetadata().exit()}return e};$.prototype.getComponentData=function(){return this.oComponentData};$.prototype.getEventBus=function(){if(!this._oEventBus){var e=sap.ui.require("sap/ui/core/EventBus");if(!e){var t=this.getMetadata().getName();a.warningThrows("The module 'sap/ui/core/EventBus' needs to be required before calling #getEventBus() on Component '"+t+"'.");(()=>{y.warning("Synchronous loading of EventBus, due to #getEventBus() call on Component '"+t+"'.","SyncXHR",null,function(){return{type:"SyncXHR",name:t}});e=sap.ui.requireSync("sap/ui/core/EventBus")})()}this._oEventBus=new e;if(!this.isActive()){this._oEventBus.suspend()}}return this._oEventBus};$.prototype.isActive=function(){return this._bIsActive};$.prototype.initComponentModels=function(){var e=this.getMetadata();if(e.isBaseClass()){return}var t=this._getManifestEntry("/sap.app/dataSources",true)||{};var n=this._getManifestEntry("/sap.ui5/models",true)||{};this._initComponentModels(n,t,this._mCacheTokens)};$.prototype._initComponentModels=function(e,t,n){var o=this.getManifestObject().getComponentName();var i=z({models:e,dataSources:t,componentName:o});if(this._bSyncCreation){V(i,o,this._bSyncCreation)}var a=J({models:i,dataSources:t,component:this,mergeParent:true,cacheTokens:n,activeTerminologies:this.getActiveTerminologies()}),r={},s;if(!a){return}for(s in a){if(!this._mManifestModels[s]){r[s]=a[s]}}var c=K(r,this._componentConfig,this.getManifestObject(),$.getOwnerIdFor(this));for(s in c){this._mManifestModels[s]=c[s]}for(s in this._mManifestModels){var u=this._mManifestModels[s];this.setModel(u,s||undefined)}};$.prototype.getService=function(e){if(!this._mServices[e]){this._mServices[e]={};this._mServices[e].promise=new Promise(function(t,n){sap.ui.require(["sap/ui/core/service/ServiceFactoryRegistry"],function(o){var i=this._getManifestEntry("/sap.ui5/services/"+e,true);var a=i&&i.factoryName;if(!a){n(new Error("Service "+e+" not declared!"));return}var r=o.get(a);if(r){r.createInstance({scopeObject:this,scopeType:"component",settings:i.settings||{}}).then(function(o){if(!this.bIsDestroyed){this._mServices[e].instance=o;this._mServices[e].interface=o.getInterface();t(this._mServices[e].interface)}else{n(new Error("Service "+e+" could not be loaded as its Component was destroyed."))}}.bind(this)).catch(n)}else{var s="The ServiceFactory "+a+" for Service "+e+" not found in ServiceFactoryRegistry!";var c=this._getManifestEntry("/sap.ui5/services/"+e+"/optional",true);if(!c){y.error(s)}n(new Error(s))}}.bind(this),n)}.bind(this))}return this._mServices[e].promise};function W(e,t){var n=e._getManifestEntry("/sap.ui5/services",true);var o=t?[]:null;if(!n){return o}var i=Object.keys(n);if(!t&&i.some(function(e){return n[e].startup===U.waitFor})){throw new Error('The specified component "'+e.getMetadata().getName()+'" cannot be loaded in sync mode since it has some services declared with "startup" set to "waitFor"')}return i.reduce(function(t,o){if(n[o].lazy===false||n[o].startup===U.waitFor||n[o].startup===U.eager){var i=e.getService(o);if(n[o].startup===U.waitFor){t.push(i)}}return t},o)}$.prototype.createComponent=function(e){v(typeof e==="string"&&e||typeof e==="object"&&typeof e.usage==="string"&&e.usage,"vUsage either must be a non-empty string or an object with a non-empty usage id");var t={async:true};if(e){var n;if(typeof e==="object"){n=e.usage;["id","async","settings","componentData"].forEach(function(n){if(e[n]!==undefined){t[n]=e[n]}})}else if(typeof e==="string"){n=e}t=this._enhanceWithUsageConfig(n,t)}if(!this.isActive()){throw new Error("Creation of component '"+t.name+"' is not possible due to inactive owner component '"+this.getId()+"'")}const o=t.async;const i=this.runAsOwner(()=>{if(o===true){return $.create(t)}else{return sap.ui.component(t)}});if(i instanceof Promise){this.registerForDestroy(i)}return i};$.prototype._enhanceWithUsageConfig=function(e,t){var n=this.getManifestEntry("/sap.ui5/componentUsages/"+e);if(!n){throw new Error('Component usage "'+e+'" not declared in Component "'+this.getManifestObject().getComponentName()+'"!')}if(n.activeTerminologies){throw new Error("Terminologies vector can't be used in component usages")}return c(n,t)};$.prototype.getActiveTerminologies=function(){return this._aActiveTerminologies?this._aActiveTerminologies.slice():undefined};function q(e,t,n){var o=n?"Model":"DataSource";var a=n?'["sap.ui5"]["models"]':'["sap.app"]["dataSources"]';var r=n&&n["sap-language"]||e.searchParams.get("sap-language");var s=n&&n["sap-client"]||e.searchParams.get("sap-client");if(!r){y.warning('Component Manifest: Ignoring provided "sap-context-token='+t.cacheToken+'" for '+o+' "'+t.dataSource+'" ('+e.sourceUrl+"). "+'Missing "sap-language" URI parameter',a+'["'+t.dataSource+'"]',t.componentName);return}if(!s){y.warning('Component Manifest: Ignoring provided "sap-context-token='+t.cacheToken+'" for '+o+' "'+t.dataSource+'" ('+e.sourceUrl+"). "+'Missing "sap-client" URI parameter',a+'["'+t.dataSource+'"]',t.componentName);return}var c=i.get(I("sapClient"));if(s!==c){y.warning('Component Manifest: Ignoring provided "sap-context-token='+t.cacheToken+'" for '+o+' "'+t.dataSource+'" ('+e.sourceUrl+"). "+'URI parameter "sap-client='+s+'" must be identical with configuration "sap-client='+c+'"',a+'["'+t.dataSource+'"]',t.componentName);return}if(e.searchParams.has("sap-context-token")&&e.searchParams.get("sap-context-token")!==t.cacheToken||n&&n["sap-context-token"]&&n["sap-context-token"]!==t.cacheToken){y.warning('Component Manifest: Overriding existing "sap-context-token='+(e.searchParams.get("sap-context-token")||n["sap-context-token"])+'" with provided value "'+t.cacheToken+'" for '+o+' "'+t.dataSource+'" ('+e.sourceUrl+").",a+'["'+t.dataSource+'"]',t.componentName)}if(n){if(e.searchParams.has("sap-context-token")){y.warning('Component Manifest: Move existing "sap-context-token='+e.searchParams.get("sap-context-token")+'" to metadataUrlParams for '+o+' "'+t.dataSource+'" ('+e.sourceUrl+").",a+'["'+t.dataSource+'"]',t.componentName)}e.searchParams.delete("sap-context-token");n["sap-context-token"]=t.cacheToken}else{e.searchParams.set("sap-context-token",t.cacheToken)}}function z(e){if(!e.models){return null}var t={models:e.models,dataSources:e.dataSources||{},origin:{dataSources:{},models:{}}};var n=e.componentName;var o={};for(var i in t.models){var r=t.models[i];if(typeof r==="string"){r={dataSource:r}}if(r.dataSource){var s=t.dataSources&&t.dataSources[r.dataSource];if(typeof s==="object"){if(s.type===undefined){s.type="OData"}var c;if(!r.type){switch(s.type){case"OData":c=s.settings&&s.settings.odataVersion;if(!c||c==="2.0"){r.type="sap.ui.model.odata.v2.ODataModel"}else if(c.startsWith("4.")){r.type="sap.ui.model.odata.v4.ODataModel"}else{a.errorThrows(`${n}: Component Manifest: Provided OData version "${c}" in dataSource "${r.dataSource}" for model "${i}" is unknown. ["sap.app"]["dataSources"]["${r.dataSource}"].`,{suffix:'Falling back to default model type "sap.ui.model.odata.v2.ODataModel".'});r.type="sap.ui.model.odata.v2.ODataModel"}break;case"JSON":r.type="sap.ui.model.json.JSONModel";break;case"XML":r.type="sap.ui.model.xml.XMLModel";break;default:}}}}if(!r.type){a.errorThrows(`${n}: Component Manifest: Missing "type" for model "${i}". ["sap.ui5"]["models"]["${i}"].`);continue}o[i]=r}return o}function J(e){var t=e.component;var o=e.manifest||t.getManifestObject();var s=e.mergeParent;var c=e.cacheTokens||{};var u=t?t.getMetadata().getComponentName():o.getComponentName();var f=e.activeTerminologies;if(!e.models){return null}var p={models:e.models,dataSources:e.dataSources||{},origin:{dataSources:{},models:{}}};if(t&&s){var d=t.getMetadata();while(d instanceof n){var l=d.getManifestObject();var m=d._getManifestEntry("/sap.app/dataSources");x(p.dataSources,p.origin.dataSources,m,l);var g=d._getManifestEntry("/sap.ui5/models");x(p.models,p.origin.models,g,l);d=d.getParent()}}var v={};for(var M in p.models){var _=p.models[M];var w=sap.ui.require(_.type.replace(/\./g,"/"));if(!w){w=b.get(_.type)}if(!w?.getMetadata){a.errorThrows(`${u}: Component Manifest: Class "${_.type}" for model "${M}" could not be found. ["sap.ui5"]["models"]["${M}"].`);continue}var C=w.getMetadata();var O=C.isA("sap.ui.model.odata.ODataModel");var E=C.isA("sap.ui.model.odata.v2.ODataModel");var A=C.isA("sap.ui.model.odata.v4.ODataModel");var T=C.isA("sap.ui.model.resource.ResourceModel");var P=false;var U=null;if(typeof _==="string"){_={dataSource:_}}if(_.dataSource){var D=p.dataSources&&p.dataSources[_.dataSource];if(typeof D==="object"){if(D.type===undefined){D.type="OData"}if(A&&D.settings&&D.settings.odataVersion){_.settings=_.settings||{};_.settings.odataVersion=D.settings.odataVersion}if(!_.uri){_.uri=D.uri;P=true}if(D.type==="OData"&&D.settings){_.settings=_.settings||{};if(typeof D.settings.maxAge==="number"){_.settings.headers=_.settings.headers||{};_.settings.headers["Cache-Control"]="max-age="+D.settings.maxAge}if("ignoreAnnotationsFromMetadata"in D.settings){_.settings.ignoreAnnotationsFromMetadata=D.settings.ignoreAnnotationsFromMetadata}if(D.settings.annotations){var N=D.settings.annotations;for(var k=0;k<N.length;k++){var R=N[k];var B=p.dataSources[R];if(!B){a.errorThrows(`${u}: Component Manifest: ODataAnnotation "${R}" for dataSource "${_.dataSource}" could not be found in manifest. ["sap.app"]["dataSources"]["${R}"].`);continue}if(B.type!=="ODataAnnotation"){a.errorThrows(`${u}: Component Manifest: dataSource "${R}" was expected to have type "ODataAnnotation" but was "${B.type}". ["sap.app"]["dataSources"]["${R}"].`);continue}if(!B.uri){a.errorThrows(`${u}: Component Manifest: Missing "uri" for ODataAnnotation "${R}". ["sap.app"]["dataSources"]["${R}"].`);continue}var F=new h(B.uri);if(E||A){var $=r.getSAPLogonLanguage();if(!F.searchParams.has("sap-language")&&$){F.searchParams.set("sap-language",$)}$=i.get(I("sapClient"));if(!F.searchParams.has("sap-client")&&$){F.searchParams.set("sap-client",$)}var H=c.dataSources&&c.dataSources[B.uri];if(H){q(F,{cacheToken:H,componentName:u,dataSource:R})}}var L=p.origin.dataSources[N[k]]||o;var W=L.resolveUri(F.sourceUrl);_.settings.annotationURI=_.settings.annotationURI||[];_.settings.annotationURI.push(W)}}}}else{a.errorThrows(`${u}: Component Manifest: dataSource "${_.dataSource}" for model "${M}" not found or invalid. ["sap.app"]["dataSources"]["${_.dataSource}"].`);continue}}if(O&&(!_.settings||_.settings.json===undefined)){_.settings=_.settings||{};_.settings.json=true}if(T){if(_.uri&&_.settings&&_.settings.bundleUrl){y.warning("Defining both model uri and bundleUrl is not supported. Only model uri will be resolved.")}if(!_.uri&&_.settings&&_.settings.terminologies){if(_.bundleUrl||_.settings.bundleUrl){_.uri=_.bundleUrl||_.settings.bundleUrl;delete _.settings.bundleUrl}}}if(_.uri){var z=new h(_.uri);var J=(P?p.origin.dataSources[_.dataSource]:p.origin.models[M])||o;z=new h(J.resolveUri(_.uri));if(_.dataSource){j(z);if(E||A){var V=p.dataSources&&p.dataSources[_.dataSource];var K=c.dataSources&&c.dataSources[V.uri];U=_.settings&&_.settings.metadataUrlParams;var X=(!U||typeof U["sap-language"]==="undefined")&&!z.searchParams.has("sap-language")&&r.getSAPLogonLanguage();if(X||K){_.settings=_.settings||{};U=_.settings.metadataUrlParams=_.settings.metadataUrlParams||{};if(X){U["sap-language"]=r.getSAPLogonLanguage()}}if(K){q(z,{cacheToken:K,componentName:u,dataSource:M},U)}}}_.uri=z.sourceUrl}if(_.uriSettingName===undefined){if(O||E||A){_.uriSettingName="serviceUrl"}else if(T){_.uriSettingName="bundleUrl"}else{}}var G;var Y;if(t){Y=t.getComponentData()}else{Y=e.componentData}G=Y&&Y.startupParameters&&Y.startupParameters["sap-system"];if(!G){G=i.get(I("sapSystem"))}var Q=false;var Z;if(G&&(O||E||A)){Q=true;Z=sap.ui.require("sap/ui/model/odata/ODataUtils")}if(_.uri){if(Q){_.preOriginBaseUri=_.uri.split("?")[0];_.uri=Z.setOrigin(_.uri,{alias:G});_.postOriginBaseUri=_.uri.split("?")[0]}if(_.uriSettingName!==undefined){_.settings=_.settings||{};if(!_.settings[_.uriSettingName]){_.settings[_.uriSettingName]=_.uri}}else if(_.settings){_.settings=[_.uri,_.settings]}else{_.settings=[_.uri]}}else if(Q&&_.uriSettingName!==undefined&&_.settings&&_.settings[_.uriSettingName]){_.preOriginBaseUri=_.settings[_.uriSettingName].split("?")[0];_.settings[_.uriSettingName]=Z.setOrigin(_.settings[_.uriSettingName],{alias:G});_.postOriginUri=_.settings[_.uriSettingName].split("?")[0]}if(Q&&_.settings&&_.settings.annotationURI){var ee=[].concat(_.settings.annotationURI);var te=[];for(var ne=0;ne<ee.length;ne++){te.push(Z.setAnnotationOrigin(ee[ne],{alias:G,preOriginBaseUri:_.preOriginBaseUri,postOriginBaseUri:_.postOriginBaseUri}))}_.settings.annotationURI=te}if(T&&_.settings){if(f){_.settings.activeTerminologies=f}S._processResourceConfiguration(_.settings,{alreadyResolvedOnRoot:true,baseURI:o._oBaseUri,manifestBaseURI:o._oManifestBaseUri,relativeTo:undefined})}if(_.settings&&!Array.isArray(_.settings)){_.settings=[_.settings]}v[M]=_}if(o.getEntry("/sap.ui5/commands")||t&&t._getManifestEntry("/sap.ui5/commands",true)){v["$cmd"]={type:"sap.ui.model.json.JSONModel"}}return v}function V(e,t,n){const o=[];function i(e,n,o){a.errorThrows(`${t}: Component Manifest: Class "${e}" for model "${n}" could not be loaded. ["sap.ui5"]["models"]["${n}"].`,{cause:o})}for(const t in e){const a=e[t];const r=a.type.replace(/\./g,"/");if(n){try{sap.ui.requireSync(r)}catch(e){i(a.type,t,e)}continue}o.push(new Promise((e,t)=>{sap.ui.require([r],e,t)}).catch(i.bind(null,a.type,t)))}return Promise.all(o)}function K(e,n,o,i){var a={};for(var r in e){var s=e[r];let p;p=b.get(s.type);if(!p){p=sap.ui.require(s.type.replace(/\./g,"/"))}var c=[null].concat(s.settings||[]);var u=p.bind.apply(p,c);var f=new u;if(f.isA("sap.ui.model.odata.v2.ODataModel")||f.isA("sap.ui.model.odata.v4.ODataModel")){const e={factoryConfig:n,manifest:o,model:f,modelId:r};const a=$.getComponentById(i);if(a){e.owner={id:i,config:a._componentConfig}}t.onModelCreated.execute(e)}a[r]=f}return a}function X(e){var t={afterManifest:{},afterPreload:{}};var n=u({},e.getEntry("/sap.app/dataSources"));var o=u({},e.getEntry("/sap.ui5/models"));var i=e.getComponentName();var a=z({models:o,dataSources:n,componentName:i});var r=new URLSearchParams(window.location.search).get("sap-ui-xx-preload-component-models-"+e.getComponentName());var s=r&&r.split(",");for(var c in a){var f=a[c];if(!f.preload&&s&&s.indexOf(c)>-1){f.preload=true;y.warning('FOR TESTING ONLY!!! Activating preload for model "'+c+'" ('+f.type+")",i,"sap.ui.core.Component")}if(f.type==="sap.ui.model.resource.ResourceModel"&&(!f.settings||f.settings.async!==true)){t.afterPreload[c]=f}else if(f.preload){if(sap.ui.loader._.getModuleState(f.type.replace(/\./g,"/")+".js")){t.afterManifest[c]=f}else{y.warning('Can not preload model "'+c+'" as required class has not been loaded: "'+f.type+'"',i,"sap.ui.core.Component")}}}return t}function G(e){return sap.ui.require.toUrl(e.replace(/\./g,"/")+"/manifest.json")}function Y(e,t){w.registerResourcePath(e.replace(/\./g,"/"),t)}function Q(e){var t=[];function o(e){if(!e._oManifest){var i=e.getComponentName();var a=G(i);var r=w.loadResource({url:a,dataType:"json",async:true}).catch(function(e){y.error('Failed to load component manifest from "'+a+'" (component '+i+")! Reason: "+e);return{}}).then(async function(t){if(t){e._applyManifest(t,true);await B(e.getManifestObject());return e.getManifestObject()._processI18n(true)}});t.push(r)}var s=e.getParent();if(s&&s instanceof n&&!s.isBaseClass()){o(s)}}o(e);return Promise.all(t)}$.create=function(e){if(e==null||typeof e!=="object"){throw new TypeError("Component.create() must be called with a configuration object.")}var t=u({},e);t.async=true;if(t.manifest===undefined){t.manifest=true}return te(t)};sap.ui.component=function(e){if(!e){throw new Error("sap.ui.component cannot be called without parameter!")}var t=function(e){return{type:"sap.ui.component",name:e}};if(typeof e==="string"){y.warning("Do not use deprecated function 'sap.ui.component' ("+e+") + for Component instance lookup. "+"Use 'Component.get' instead","sap.ui.component",null,t.bind(null,e));return $.getComponentById(e)}if(e.async){y.info("Do not use deprecated factory function 'sap.ui.component' ("+e["name"]+"). "+"Use 'Component.create' instead","sap.ui.component",null,t.bind(null,e["name"]))}else{y.warning("Do not use synchronous component creation ("+e["name"]+")! "+"Use the new asynchronous factory 'Component.create' instead","sap.ui.component",null,t.bind(null,e["name"]))}return te(e,true)};function Z(e,t){const n=new M;e=e.replace("module:","");sap.ui.require([e],n.resolve,o=>{a.warningRejects(n.resolve,n.reject,`sap.ui.core.Component: Cannot load module '${e}' during creation of component: "${t}".`);y.warning(o)});return n.promise}function ee(e){const t=e.collectRoutingClasses?.()??{};return Object.values(t)}function te(e,o){var i=$.getComponentById(P());if(Array.isArray(e.activeTerminologies)&&e.activeTerminologies.length&&Array.isArray(r.getActiveTerminologies())&&r.getActiveTerminologies().length){if(JSON.stringify(e.activeTerminologies)!==JSON.stringify(r.getActiveTerminologies())){y.warning(o?"sap.ui.component: ":"Component.create: "+"The 'activeTerminolgies' passed to the component factory differ from the ones defined on the global 'sap/base/i18n/Localization.getActiveTerminologies';"+"This might lead to inconsistencies; ResourceModels that are not defined in the manifest and created by the component will use the globally configured terminologies.")}}var a=e.activeTerminologies||i&&i.getActiveTerminologies()||r.getActiveTerminologies();if(!e.asyncHints||!e.asyncHints.cacheTokens){var c=i&&i._mCacheTokens;if(typeof c==="object"){e.asyncHints=e.asyncHints||{};e.asyncHints.cacheTokens=c}}function u(e,n){if(n.async){var o=e.rootControlLoaded?e.rootControlLoaded():Promise.resolve();var i=t.onInstanceCreated.execute(e,n)||[];i.push(o);return Promise.all(i)}else{t.onInstanceCreated.execute(e,n)}return e}function f(t){if(o&&t.getMetadata().isA("sap.ui.core.IAsyncContentCreation")){throw new Error("Do not use deprecated factory function 'sap.ui.component' in combination with IAsyncContentCreation ("+e["name"]+"). "+"Use 'Component.create' instead")}var n=e.name,i=e.id,r=e.componentData,c=n+".Component",f=e.settings;var p=new t(s({},f,{id:i,componentData:r,_cacheTokens:e.asyncHints&&e.asyncHints.cacheTokens,_activeTerminologies:a,_componentConfig:e,_syncCreation:!e.async}));v(p instanceof $,'The specified component "'+c+'" must be an instance of sap.ui.core.Component!');y.info("Component instance Id = "+p.getId());if(m.getPending()?.maybeA2A){var d=p.getManifestEntry("sap.app");if(d?.type==="application"){m.getNavInfo().set(m.getPending().hash,p.getId());delete m.getPending().maybeA2A}}var l=p.getMetadata()._getManifestEntry("/sap.ui5/handleValidation");if(l!==undefined||e.handleValidation){const t=sap.ui.require("sap/ui/core/Messaging");if(t){t.registerObject(p,l===undefined?e.handleValidation:l)}else{sap.ui.require(["sap/ui/core/Messaging"],function(t){if(!p.isDestroyed()){t.registerObject(p,l===undefined?e.handleValidation:l)}})}}var g=W(p,e.async);if(e.async){return u(p,e).then(function(){return Promise.all(g)}).then(function(){return p})}else{return u(p,e)}}var p=ne(e,{failOnError:true,createModels:true,waitFor:e.asyncHints&&e.asyncHints.waitFor,activeTerminologies:a});if(e.async){var d=P();return p.then(function(e){var t=function(e){var o=e.getParent();var i=Promise.resolve();if(o instanceof n){i=i.then(function(){return t(o)})}return i.then(function(){return e.getManifestObject().loadDependenciesAndIncludes(true)})};return t(e.getMetadata()).then(async function(){const t=e.getMetadata();const n=t.getManifestObject();const o=n.getComponentName();const i=ee(t);const a=i.map(e=>{let t;if(typeof e==="function"){t=Promise.resolve(e)}else{t=Z(e,o)}return t});const r=D(t,n,"/sap.app/dataSources",true)||{};const s=D(t,n,"/sap.ui5/models",true)||{};const c=z({models:s,dataSources:r,componentName:o});const u=V(c,o);await Promise.all([...a,u]);return T(function(){return f(e)},d)})})}else{return f(p)}}$.load=function(e){var t=u({},e);t.async=true;if(t.manifest===undefined){t.manifest=true}return ne(t,{preloadOnly:t.asyncHints&&t.asyncHints.preloadOnly})};$.get=function(e){return $.getComponentById(e)};$.getComponentById=function(e){return E.get(e)};sap.ui.component.load=function(e,t){y.warning("Do not use deprecated function 'sap.ui.component.load'! Use 'Component.load' instead");return ne(e,{failOnError:t,preloadOnly:e.asyncHints&&e.asyncHints.preloadOnly})};function ne(n,o){var r=o.activeTerminologies,s=n.name,f=n.url,p=/^(sync|async)$/.test($.getComponentPreloadMode()),l=n.manifest,g,h,M,b,_,w;const{promise:C,resolve:S,reject:E}=Promise.withResolvers();const A="sap.ui.fl";function T(t,o){var i=JSON.parse(JSON.stringify(t));if(n.async){return U(i).then(function(t){return new e(t,o)})}else{return new e(i,o)}}async function U(e){await C;if(t.onPreprocessManifest.isRegistered()&&e!=null){try{var o=c({},n);return t.onPreprocessManifest.execute(e,o)}catch(e){y.error("Failed to execute flexibility hook for manifest preprocessing.",e);return Promise.reject(e)}}else{return Promise.resolve(e)}}v(!f||typeof f==="string","sUrl must be a string or undefined");if(s&&typeof f==="string"){Y(s,f)}m.setStepComponent(s);if(l===undefined){g=n.manifestFirst===undefined?i.get({name:"sapUiManifestFirst",type:i.Type.Boolean,external:true}):!!n.manifestFirst;h=n.manifestUrl}if(l!==undefined){if(n.async===undefined){n.async=true}g=!!l;h=l&&typeof l==="string"?l:undefined;M=l&&typeof l==="object"?T(l,{url:n&&n.altManifestUrl,activeTerminologies:r,process:!n.async}):undefined}if(!M&&h){M=e.load({activeTerminologies:r,manifestUrl:h,componentName:s,processJson:U,async:n.async,failOnError:true})}if(M&&!n.async){s=M.getComponentName();if(s&&typeof f==="string"){Y(s,f)}}if(!(M&&n.async)){if(!s){throw new Error("The name of the component is undefined.")}v(typeof s==="string","sName must be a string")}if(g&&!M){M=e.load({activeTerminologies:r,manifestUrl:G(s),componentName:s,async:n.async,processJson:U,failOnError:false})}function I(){return(s+".Component").replace(/\./g,"/")}function j(e){var t=s+".Component";if(!e){var n="The specified component controller '"+t+"' could not be found!";if(o.failOnError){throw new Error(n)}else{a.warningThrows(n)}}if(M){var i=N(e.getMetadata(),M);var r=function(){var t=Array.prototype.slice.call(arguments);var n;if(t.length===0||typeof t[0]==="object"){n=t[0]=t[0]||{}}else if(typeof t[0]==="string"){n=t[1]=t[1]||{}}n._metadataProxy=i;if(b){n._manifestModels=b}var o=Object.create(e.prototype);e.apply(o,t);return o};i.getClass=function(){return r};r[Symbol("isProxy")]=true;r.getMetadata=function(){return i};r.extend=function(){throw new Error("Extending Components created by Manifest is not supported!")};return r}else{return e}}function x(e,t){v(typeof e==="string"&&e||typeof e==="object"&&typeof e.name==="string"&&e.name,"reference either must be a non-empty string or an object with a non-empty 'name' and an optional 'url' property");if(typeof e==="object"){if(e.url){Y(e.name,e.url)}return e.lazy&&t!==true?undefined:e.name}return e}function D(e,t){var n=e+".Component",o=d.isDepCacheEnabled(),i,a,r,s=function(e,t){return function(n){var o="Component-preload for this component does not exist.";y.warning("Couldn't preload component from "+e+": "+(n&&n.message||n),!t?o:o+" If the component is part of a library or another component, the configuration 'sap.app/embeddedBy' is not maintained. "+" The 'sap.app/embeddedBy' property must be relative path inside the deployment unit (library or component).","sap.ui.core.Component#preload")}};if(p&&e!=null&&!sap.ui.loader._.getModuleState(n.replace(/\./g,"/")+".js")){if(t){a=O._getTransitiveDependencyForComponent(e);if(a&&!a.hasOwnPreload){r=[a.library];Array.prototype.push.apply(r,a.dependencies);return d._load(r,{preloadOnly:true}).catch(s(a.library,true))}else{i=n.replace(/\./g,"/")+(o?"-h2-preload.js":"-preload.js");return sap.ui.loader._.loadJSResourceAsync(i).catch(s(i,true))}}else{try{i=n+"-preload";sap.ui.requireSync(i.replace(/\./g,"/"))}catch(e){s(i,false)(e)}}}else if(t){return Promise.resolve()}}function k(e,t,n){var o=[];var i=n?function(e){o.push(e)}:function(){};var a=t.getEntry("/sap.ui5/dependencies/libs");if(a){var r=[];for(var s in a){if(!a[s].lazy){r.push(s)}}if(r.length>0){y.info('Component "'+e+'" is loading libraries: "'+r.join(", ")+'"');i(d._load(r,{sync:!n}))}}var c=t.getEntry("/sap.ui5/extends/component");if(c){i(D(c,n))}var u=[];var f=t.getEntry("/sap.ui5/dependencies/components");if(f){for(var p in f){if(!f[p].lazy){u.push(p)}}}var l=t.getEntry("/sap.ui5/componentUsages");if(l){for(var m in l){if(l[m].lazy===false&&u.indexOf(l[m].name)===-1){u.push(l[m].name)}}}if(u.length>0){u.forEach(function(e){i(D(e,n))})}return n?Promise.all(o):undefined}if(n.async){var R=n.asyncHints||{},H=[],L=function(e){e=e.then(function(e){return{result:e,rejected:false}},function(e){return{result:e,rejected:true}});return e},W=function(e){if(e){H.push(L(e))}},q=function(e){return e},te,ne;te=[];if(Array.isArray(R.preloadBundles)){R.preloadBundles.forEach(function(e){te.push(sap.ui.loader._.loadJSResourceAsync(x(e,true),true))})}if(Array.isArray(R.libs)){ne=R.libs.map(x).filter(q);if(!ne.includes(A)||o.preloadOnly){S()}te.push(d._load(ne,{preloadOnly:true}))}else{S()}te=Promise.all(te);if(ne&&!o.preloadOnly){te=te.then(function(){let e=Promise.resolve();if(ne.includes(A)){ne=ne.filter(e=>e!==A);e=d._load([A]).then(S).catch(E)}return Promise.all([e,d._load(ne)])})}W(te);if(R.components){Object.keys(R.components).forEach(function(e){W(D(x(R.components[e]),true))})}if(!M){W(D(s,true))}else{var oe=[];M=M.then(async function(e){var t=e.getComponentName();if(typeof f==="string"){Y(t,f)}e.defineResourceRoots();await B(e);e._preprocess({resolveUI5Urls:true,i18nProperties:oe});return e});if(o.createModels){const e=P();W(M.then(async function(t){var o=t.getComponentName();_=X(t);if(Object.keys(_.afterManifest).length>0){await V(_.afterManifest,o);var i=u({},t.getEntry("/sap.app/dataSources"));var a=J({models:_.afterManifest,dataSources:i,manifest:t,componentData:n.componentData,cacheTokens:R.cacheTokens,activeTerminologies:r});b=K(a,n,t,e)}return t}))}W(M.then(function(e){var t=Promise.resolve();var i=e.getEntry("/sap.app/embeddedBy");var a=e.getComponentName();if(!i){t=D(a,true)}else if(!sap.ui.loader._.getModuleState(I()+".js")){y.warning("Component '"+a+"' is defined to be embedded in a library or another component"+"The relatively given preload for the embedding resource was not loaded before hand. "+"Please make sure to load the embedding resource containing this Component before instantiating.",undefined,"sap.ui.core.Component#embeddedBy")}return t.then(function(){return e._processI18n(true,oe)}).then(function(){if(!o.createModels){return null}var t=Object.keys(_.afterPreload);if(t.length===0){return null}return new Promise(function(e,t){sap.ui.require(["sap/ui/model/resource/ResourceModel"],function(t){e(t)},t)}).then(function(i){var a=u({},e.getEntry("/sap.app/dataSources"));var s=J({models:_.afterPreload,dataSources:a,manifest:e,componentData:n.componentData,cacheTokens:R.cacheTokens,activeTerminologies:r});function c(t){var n=s[t];if(Array.isArray(n.settings)&&n.settings.length>0){var a=n.settings[0];a.activeTerminologies=o.activeTerminologies;return i.loadResourceBundle(a,true).then(function(e){a.bundle=e;delete a.terminologies;delete a.activeTerminologies;delete a.enhanceWith},function(n){y.error("Component Manifest: Could not preload ResourceBundle for ResourceModel. "+"The model will be skipped here and tried to be created on Component initialization.",'["sap.ui5"]["models"]["'+t+'"]',e.getComponentName());y.error(n);delete s[t]})}else{return Promise.resolve()}}return Promise.all(t.map(c)).then(function(){if(Object.keys(s).length>0){var e=K(s);if(!b){b={}}for(var t in e){b[t]=e[t]}}})})})}));w=function(e){if(t.onComponentLoaded.isRegistered()){var o=c({},n);try{return t.onComponentLoaded.execute(o,e)}catch(t){a.errorThrows('sap.ui.core.Component: Callback for loading the component "'+e.getComponentName()+'" run into an error.',{cause:t,suffix:"The callback was skipped and the component loading resumed."})}}}}return Promise.all(H).then(function(e){var t=[],n=false,o;n=e.some(function(e){if(e&&e.rejected){o=e.result;return true}t.push(e.result);return false});if(n){return Promise.reject(o)}return t}).then(function(e){if(M&&w){return M.then(w).then(function(){return e})}return e}).then(function(e){y.debug("Component.load: all promises fulfilled, then "+e);if(M){return M.then(function(e){if(!e._bLoadManifestRequestFailed){M=e;s=M.getComponentName();return k(s,M,true)}else{M=undefined;return M}})}else{return e}}).then(function(){if(o.preloadOnly){return true}return new Promise(function(e,t){sap.ui.require([I()],function(t){e(t)},t)}).then(function(t){var n=t.getMetadata();var i=n.getComponentName();var a=G(i);var s=[];if(M&&typeof l!=="object"&&(typeof h==="undefined"||h===a)){n._applyManifest(JSON.parse(JSON.stringify(M.getRawJson())),true);const e=B(n.getManifestObject()).then(()=>n.getManifestObject()._processI18n(true));s.push(e)}s.push(Q(n));return Promise.all(s).then(function(){var i=Promise.resolve();if(!M&&Array.isArray(o.activeTerminologies)&&o.activeTerminologies.length>0){M=new e(n.getManifestObject().getRawJson(),{process:false,activeTerminologies:r});i=B(n.getManifestObject()).then(()=>M._processI18n(true))}return i.then(j.bind(undefined,t))})})}).then(function(e){if(!M){return e}const t=e.getMetadata();const n=ee(t);var o=u({},M.getEntry("/sap.ui5/models"));var i=u({},M.getEntry("/sap.app/dataSources"));var a=z({models:o,dataSources:i,componentName:M.getComponentName()});for(var r in a){if(!a.hasOwnProperty(r)){continue}var s=a[r];if(!s.type){continue}var c=s.type.replace(/\./g,"/");if(n.indexOf(c)===-1){n.push(c)}}if(n.length>0){const t=M.getComponentName();return Promise.all(n.map(function(e){return Z(e,t)})).then(function(){return e})}else{return e}}).then(function(e){var t=o.waitFor;if(t){var n=Array.isArray(t)?t:[t];return Promise.all(n).then(function(){return e})}return e}).catch(function(e){if(b){for(var t in b){var n=b[t];if(n&&typeof n.destroy==="function"){n.destroy()}}}throw e})}if(M){M.defineResourceRoots();F(M);M._preprocess({resolveUI5Urls:true});k(s,M)}D(s);return j(sap.ui.requireSync(I()))}$.registry=E;$.prototype.getCommand=function(e){if(!this._mComputedCommands){var t=$.getCustomizing(this,{type:"sap.ui.commands"})||{},n=this._getManifestEntry("/sap.ui5/commands",true)||{},o=this.getMetadata().getComponentName(),i="",a=this.getExtensionComponent&&this.getExtensionComponent();if(a&&a.getLocalId){i="#"+(a.getLocalId(this.getId())||this.getId())}this._mComputedCommands=u({},n,t[o],t[o+i])}return e?this._mComputedCommands[e]:this._mComputedCommands};$.prototype.deactivate=function(){var e=$.getOwnerComponentFor(this);if(e&&e.isActive()){throw new Error("Component.deactivate must not be called on nested components.")}if(!this.isKeepAliveSupported()){y.warning("Deactivation of component failed. Component '"+this.getId()+"' does not support 'keepAlive'.");return}if(!this.isActive()){y.warning("Deactivation of component failed. Component '"+this.getId()+"' is already inactive.");return}this.onOwnerDeactivation();this._bIsActive=false;H(function(e){l.suspend(e.getDomRef());e.onOwnerDeactivation()},this.getId());E.forEach(function(e){var t=$.getOwnerIdFor(e);if(t===this.getId()){e.deactivate()}},this);if(this._oEventBus){this._oEventBus.suspend()}if(this.getRouter()){this.getRouter().stop()}if(typeof this.onDeactivate==="function"){g(this.onDeactivate(),{name:"onDeactivate",component:this.getId()})}};$.prototype.activate=function(){if(!this.isKeepAliveSupported()){y.warning("Activation of component failed. Component '"+this.getId()+"' does not support 'keepAlive'.");return}if(this.isActive()){y.warning("Activation of component failed. Component '"+this.getId()+"' is already active.");return}this.onOwnerActivation();this._bIsActive=true;H(function(e){l.resume(e.getDomRef());e.onOwnerActivation()},this.getId());E.forEach(function(e){var t=$.getOwnerIdFor(e);if(t===this.getId()){e.activate()}},this);if(this._oEventBus){this._oEventBus.resume()}if(this.getRouter()){this.getRouter().initialize()}if(typeof this.onActivate==="function"){g(this.onActivate(),{name:"onActivate",component:this.getId()})}};$.prototype.isKeepAliveSupported=function(){var e=this._oKeepAliveConfig&&this._oKeepAliveConfig.supported;if(e){e=E.filter(function(e){var t=$.getOwnerIdFor(e);return t===this.getId()},this).every(function(e){return e.isKeepAliveSupported()},this)}return!!e};$.prototype.registerForDestroy=function(e){var t=this._getDestroyables();e=e.then(function(n){t.splice(t.indexOf(e),1);return n});t.push(e)};A.registerForUpdate("Components",E.all);return $});
//# sourceMappingURL=Component.js.map