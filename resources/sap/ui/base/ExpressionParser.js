/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/strings/escapeRegExp","sap/base/util/deepEqual","sap/base/util/JSTokenizer","sap/ui/performance/Measurement"],function(e,n,t,r,i){"use strict";
//License granted by Douglas Crockford to SAP, Apache License 2.0
//    (http://www.apache.org/licenses/LICENSE-2.0)
var u=g.bind(null,undefined),a={Array:Array,Boolean:Boolean,Date:Date,encodeURIComponent:encodeURIComponent,Infinity:Infinity,isFinite:isFinite,isNaN:isNaN,JSON:JSON,Math:Math,NaN:NaN,Number:Number,Object:Object,odata:{collection:function(e){return e.filter(function(e){return e!==undefined})},compare:function(){var e=sap.ui.require("sap/ui/model/odata/v4/ODataUtils");if(!e){e=sap.ui.requireSync("sap/ui/model/odata/v4/ODataUtils")}if(!e){throw new TypeError("Expression uses 'odata.compare' which requires to"+" import 'sap/ui/model/odata/v4/ODataUtils' in advance")}return e.compare.apply(e,arguments)},fillUriTemplate:function(e,n){let t=sap.ui.require("sap/ui/thirdparty/URITemplate");if(!t){t=sap.ui.requireSync("sap/ui/thirdparty/URITemplate")}if(!t){throw new TypeError("Expression uses 'odata.fillUriTemplate' which requires"+" to import 'sap/ui/thirdparty/URITemplate' in advance")}return new t(e.trim()).expand(n)},uriEncode:function(){var e=sap.ui.require("sap/ui/model/odata/ODataUtils");if(!e){e=sap.ui.requireSync("sap/ui/model/odata/ODataUtils")}if(!e){throw new TypeError("Expression uses 'odata.uriEncode' which requires to"+" import 'sap/ui/model/odata/ODataUtils' in advance")}return e.formatValue.apply(e,arguments)}},parseFloat:parseFloat,parseInt:parseInt,RegExp:RegExp,String:String,undefined:undefined},s=/\d/,o="sap.ui.base.ExpressionParser",l=/[a-z_$][a-z0-9_$]*/i,d=/[a-z_$]/i,c=[o],f=o+"#parse",p={BINDING:{led:U,nud:function(e,n){return x.bind(null,e.value)}},ERROR:{lbp:Infinity,led:function(e,n,t){S(e.value.message,e.value.text,e.value.at)},nud:function(e,n){S(e.value.message,e.value.text,e.value.at)}},IDENTIFIER:{led:U,nud:function(n,t){if(!(n.value in t.globals)){e.warning("Unsupported global identifier '"+n.value+"' in expression parser input '"+t.input+"'",undefined,o)}return g.bind(null,t.globals[n.value])}},CONSTANT:{led:U,nud:function(e,n){return g.bind(null,e.value)}},".":{lbp:18,led:function(e,n,t){return I.bind(null,t,n.advance("IDENTIFIER").value)},nud:U},"(":{lbp:17,led:function(e,n,t){var r=[],i=true;while(n.current().id!==")"){if(i){i=false}else{n.advance(",")}r.push(n.expression(0))}n.advance(")");return E.bind(null,t,r)},nud:function(e,n){var t=n.expression(0);n.advance(")");return t}},"[":{lbp:18,led:function(e,n,t){var r=n.expression(0);n.advance("]");return w.bind(null,t,r)},nud:function(e,n){var t=[],r=true;while(n.current().id!=="]"){if(r){r=false}else{n.advance(",")}t.push(n.current().id===","?u:n.expression(0))}n.advance("]");return h.bind(null,t)}},"!":{lbp:15,led:U,nud:function(e,n){return T.bind(null,n.expression(this.lbp),function(e){return!e})}},typeof:{lbp:15,led:U,nud:function(e,n){return T.bind(null,n.expression(this.lbp),function(e){return typeof e})}},"?":{lbp:4,led:function(e,n,t){var r,i;i=n.expression(this.lbp-1);n.advance(":");r=n.expression(this.lbp-1);return m.bind(null,t,i,r)},nud:U},")":{led:U,nud:U},"]":{led:U,nud:U},"{":{led:U,nud:function(e,n){var t=true,r,i={},u;while(n.current().id!=="}"){if(t){t=false}else{n.advance(",")}if(n.current()&&n.current().id==="CONSTANT"&&typeof n.current().value==="string"){r=n.advance().value}else{r=n.advance("IDENTIFIER").value}n.advance(":");u=n.expression(0);i[r]=u}n.advance("}");return N.bind(null,i)}},"}":{lbp:-1,led:U,nud:U},",":{led:U,nud:U},":":{led:U,nud:U}},v=["===","!==","!","||","&&",".","(",")","{","}",":",",","?","*","/","%","+","-","<=","<",">=",">","[","]"],b;v.forEach(function(e,t){v[t]=n(e)});b=new RegExp(v.join("|"),"g");R("*",14,function(e,n){return e*n});R("/",14,function(e,n){return e/n});R("%",14,function(e,n){return e%n});R("+",13,function(e,n){return e+n}).nud=function(e,n){return T.bind(null,n.expression(this.lbp),function(e){return+e})};R("-",13,function(e,n){return e-n}).nud=function(e,n){return T.bind(null,n.expression(this.lbp),function(e){return-e})};R("<=",11,function(e,n){return e<=n});R("<",11,function(e,n){return e<n});R(">=",11,function(e,n){return e>=n});R(">",11,function(e,n){return e>n});R("in",11,function(e,n){return e in n});R("===",10,function(e,n){return e===n});R("!==",10,function(e,n){return e!==n});R("&&",7,function(e,n){return e&&n()},true);R("||",6,function(e,n){return e||n()},true);function h(e,n){return e.map(function(e){return e(n)})}function x(e,n){return O(n[e])}function m(e,n,t,r){return e(r)?n(r):t(r)}function g(e){return e}function I(e,n,t,r){var i=e(t),u=i[n];if(r){r.base=i}return O(u)}function E(e,n,t){var r={};return O(e(t,r).apply(r.base,n.map(function(e){return e(t)})))}function y(e,n,t,r,i){return t(e(i),r?n.bind(null,i):n(i))}function N(e,n){var t,r={};for(t in e){r[t]=e[t](n)}return r}function w(e,n,t,r){var i=e(t),u=n(t),a=i[u];if(r){r.base=i}return O(a)}function T(e,n,t){return n(e(t))}function R(e,n,t,r){p[e]={lbp:n,led:function(e,n,i){var u=r?this.lbp-1:this.lbp;return y.bind(null,i,n.expression(u),t,r)},nud:U};return p[e]}function O(e){return e===Function?undefined:e}function S(n,t,r){var i=new SyntaxError(n);i.at=r;i.text=t;if(r!==undefined){n+=" at position "+r}e.error(n,t,o);throw i}function U(e){S("Unexpected "+e.id,e.input,e.start+1)}function D(e,n,i){var u=[],a=[],o=[],c=new r;function f(e,i,s){var o=false,l,d,c;function f(e){if(s){if(e.parts){e.parts.forEach(f)}else{e.targetType=e.targetType||"any"}}}for(l in e){if(l==="parameters"){continue}switch(typeof e[l]){case"boolean":case"number":case"string":case"undefined":break;default:o=true}}f(e);if(o){d=r.parseJS(n,i).result;f(d)}else{d=e}for(c=0;c<u.length;c+=1){if(t(a[c],d)){return c}}a[c]=d;u[c]=e;return c}function p(){var t,r,i,u,a;c.white();t=c.getCh();i=c.getIndex();if((t==="$"||t==="%")&&n[i+1]==="{"){r=e(n,i+1);a={id:"BINDING",value:f(r.result,i+1,t==="%")};c.setIndex(r.at)}else if(d.test(t)){u=l.exec(n.slice(i));switch(u[0]){case"false":case"null":case"true":a={id:"CONSTANT",value:c.word()};break;case"in":case"typeof":a={id:u[0]};c.setIndex(i+u[0].length);break;default:a={id:"IDENTIFIER",value:u[0]};c.setIndex(i+u[0].length)}}else if(s.test(t)||t==="."&&s.test(n[i+1])){a={id:"CONSTANT",value:c.number()}}else if(t==="'"||t==='"'){a={id:"CONSTANT",value:c.string()}}else{b.lastIndex=i;u=b.exec(n);if(!u||u.index!==i){return false}a={id:u[0]};c.setIndex(i+u[0].length)}a.input=n;a.start=i;a.end=c.getIndex();o.push(a);return true}c.init(n,i);try{while(p()){}}catch(e){if(e.name==="SyntaxError"){o.push({id:"ERROR",value:e})}else{throw e}}return{at:c.getIndex(),parts:u,tokens:o}}function q(n,t){return function(){try{return n.apply(this,arguments)}catch(n){e.warning(String(n),t,o)}}}function F(e,n,t){var r,i=0,u={advance:s,current:o,expression:l,globals:t,input:n},a;function s(t){var r=e[i];if(t){if(!r){S("Expected "+t+" but instead saw end of input",n)}else if(r.id!==t){S("Expected "+t+" but instead saw "+n.slice(r.start,r.end),n,r.start+1)}}i+=1;return r}function o(){return e[i]}function l(t){var r;a=s();if(!a){S("Expected expression but instead saw end of input",n)}r=p[a.id].nud(a,u);while(i<e.length){a=o();if(t>=(p[a.id].lbp||0)){break}s();r=p[a.id].led(a,u,r)}return r}r=l(0);return{at:o()&&o().start,formatter:q(r,n)}}return{parse:function(e,n,t,r,u){var s,o;i.average(f,"",c);o=D(e,n,t);r=r||a;if(u){r=Object.assign({},r,u)}s=F(o.tokens,n,r);i.end(f);if(!o.parts.length){return{constant:s.formatter(),at:s.at||o.at}}function l(){return s.formatter(arguments)}l.textFragments=true;return{result:{formatter:l,parts:o.parts},at:s.at||o.at}},_globals:a}},true);
//# sourceMappingURL=ExpressionParser.js.map