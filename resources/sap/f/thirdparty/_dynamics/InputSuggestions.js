sap.ui.define(["exports","sap/f/thirdparty/generateHighlightedMarkup","sap/f/thirdparty/ShellBarSearch2","sap/f/thirdparty/webcomponents","sap/f/thirdparty/ListItemGroup","sap/f/thirdparty/ListBoxItemGroupTemplate","sap/f/thirdparty/parameters-bundle.css2","sap/f/thirdparty/Icon","sap/f/thirdparty/List","sap/f/thirdparty/ResponsivePopover","sap/f/thirdparty/Button2","sap/f/thirdparty/i18n-defaults2","sap/f/thirdparty/encodeXML","sap/f/thirdparty/event-strict","sap/f/thirdparty/Icons","sap/f/thirdparty/ListItemBase","sap/f/thirdparty/parameters-bundle.css","sap/f/thirdparty/ListItemAdditionalText.css","sap/f/thirdparty/AccessibilityTextsHelper","sap/f/thirdparty/ValueState","sap/f/thirdparty/information","sap/f/thirdparty/Label","sap/f/thirdparty/slim-arrow-down","sap/f/thirdparty/Title","sap/f/thirdparty/BusyIndicator","sap/f/thirdparty/willShowContent","sap/f/thirdparty/information2","sap/f/thirdparty/sys-enter-2","sap/f/thirdparty/parameters-bundle.css3","sap/f/thirdparty/i18n-defaults","sap/f/thirdparty/toLowercaseEnumValue","sap/f/thirdparty/WrappingType","sap/f/thirdparty/FocusableElements"],function(e,t,s,i,n,o,r,a,l,c,h,u,d,p,m,I,g,f,_,x,S,v,y,P,C,T,b,w,L,O,R,j,A){"use strict";var k=this&&this.__decorate||function(e,t,s,i){var n=arguments.length,o=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)if(r=e[a])o=(n<3?r(o):n>3?r(t,s,o):r(t,s))||o;return n>3&&o&&Object.defineProperty(t,s,o),o};let B=class e extends n.ListItemGroup{};k([i.d({default:true,invalidateOnChildChange:true,type:HTMLElement})],B.prototype,"items",void 0);B=k([i.m({tag:"ui5-suggestion-item-group",template:o.ListItemGroupTemplate})],B);B.define();function D(e){const t=e?.suggestionsList||G;const i=e?.valueStateMessage;const n=e?.valueStateMessageInputIcon;return r.jsxs(c.ResponsivePopover,{class:this.classes.popover,hideArrow:true,preventFocusRestore:true,preventInitialFocus:true,placement:"Bottom",horizontalAlign:"Start",tabindex:-1,style:this.styles.suggestionsPopover,onOpen:this._afterOpenPicker,onClose:this._afterClosePicker,onScroll:this._scroll,open:this.open,opener:this,accessibleName:this._popupLabel,children:[this._isPhone&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{slot:"header",class:"ui5-responsive-popover-header",children:[r.jsx("div",{class:"row",children:r.jsx("span",{children:this._headerTitleText})}),r.jsx("div",{class:"row",children:r.jsx("div",{class:"input-root-phone native-input-wrapper",children:r.jsx(s.Input,{class:"ui5-input-inner-phone",type:this.inputType,value:this.value,showClearIcon:this.showClearIcon,placeholder:this.placeholder,onInput:this._handleInput,onChange:this._handleChange})})})]}),this.hasValueStateMessage&&r.jsxs("div",{class:this.classes.popoverValueState,style:this.styles.suggestionPopoverHeader,children:[r.jsx(a.Icon,{class:"ui5-input-value-state-message-icon",name:n?.call(this)}),this.open&&i?.call(this)]})]}),!this._isPhone&&this.hasValueStateMessage&&r.jsxs("div",{slot:"header",class:{"ui5-responsive-popover-header":true,...this.classes.popoverValueState},style:this.styles.suggestionPopoverHeader,children:[r.jsx(a.Icon,{class:"ui5-input-value-state-message-icon",name:n?.call(this)}),this.open&&i?.call(this)]}),t.call(this),this._isPhone&&r.jsxs("div",{slot:"footer",class:"ui5-responsive-popover-footer",children:[r.jsx(h.Button,{design:"Emphasized",onClick:this._closePicker,children:this._suggestionsOkButtonText}),r.jsx(h.Button,{class:"ui5-responsive-popover-close-btn",design:"Transparent",onClick:this._closePicker,children:this._suggestionsCancelButtonText})]})]})}function G(){return r.jsx(l.List,{accessibleRole:l.ListAccessibleRole.ListBox,separators:this.suggestionSeparators,selectionMode:"Single",onMouseDown:this.onItemMouseDown,onItemClick:this._handleSuggestionItemPress,onSelectionChange:this._handleSelectionChange,children:r.jsx("slot",{})})}class V{get template(){return D}constructor(e,t,s,i){this.component=e;this.slotName=t;this.handleFocus=i;this.highlight=s;this.selectedItemIndex=-1}onUp(e,t){e.preventDefault();const s=!this.isOpened&&this._hasValueState&&t===-1?0:t;this._handleItemNavigation(false,s);return true}onDown(e,t){e.preventDefault();const s=!this.isOpened&&this._hasValueState&&t===-1?0:t;this._handleItemNavigation(true,s);return true}onSpace(e){if(this._isItemOnTarget()){e.preventDefault();this.onItemSelected(this._selectedItem,true);return true}return false}onEnter(e){if(this._isGroupItem){e.preventDefault();return false}if(this._isItemOnTarget()){this.onItemSelected(this._selectedItem,true);return true}return false}onPageUp(e){e.preventDefault();const t=this.selectedItemIndex-10>-1;this._moveItemSelection(this.selectedItemIndex,t?this.selectedItemIndex-=10:this.selectedItemIndex=0);return true}onPageDown(e){e.preventDefault();const t=this._getItems();if(!t){return true}const s=t.length-1;const i=this.selectedItemIndex+10<=s;this._moveItemSelection(this.selectedItemIndex,i?this.selectedItemIndex+=10:this.selectedItemIndex=s);return true}onHome(e){e.preventDefault();this._moveItemSelection(this.selectedItemIndex,this.selectedItemIndex=0);return true}onEnd(e){e.preventDefault();const t=this._getItems().length-1;if(!t){return true}this._moveItemSelection(this.selectedItemIndex,this.selectedItemIndex=t);return true}onTab(){if(this._isItemOnTarget()){this.onItemSelected(this._selectedItem,true);return true}return false}toggle(e,t){const s=e!==undefined?e:!this.isOpened();if(s){this._getComponent().open=true}else{this.close(t.preventFocusRestore)}}get _selectedItem(){return this._getNonGroupItems().find(e=>e.selected)}_isScrollable(){const e=this._getScrollContainer();return e.offsetHeight<e.scrollHeight}close(e=false){const t=this._getItems()&&this._getItems()[this.selectedItemIndex];this._getComponent().open=false;const s=this._getPicker();s.preventFocusRestore=e;s.open=false;if(t&&t.focused){t.focused=false}}updateSelectedItemPosition(e){this.selectedItemIndex=e}onItemSelected(e,t){const s=e;const i=this._getNonGroupItems();if(!s){return}this.accInfo={isGroup:s.hasAttribute("ui5-suggestion-item-group"),currentPos:i.indexOf(s)+1,listSize:i.length,itemText:s.text||"",additionalText:s.additionalText};this._getComponent().onItemSelected(s,t);this._getComponent().open=false}onItemSelect(e){this._getComponent().onItemSelect(e)}onItemPress(e){let t;const s=e.type==="ui5-item-click";if(s&&!e.detail.item.selected||this._handledPress&&!s){return}if(s&&e.detail.item.selected){t=e.detail.item;this._handledPress=true}else{t=e.detail.selectedItems[0]}this.onItemSelected(t,false)}_onClose(){this._handledPress=false}_isItemOnTarget(){return this.isOpened()&&this.selectedItemIndex!==null&&this.selectedItemIndex!==-1&&!this._isGroupItem}get _isGroupItem(){const e=this._getItems();if(!e||!e[this.selectedItemIndex]){return false}return e[this.selectedItemIndex].hasAttribute("ui5-suggestion-item-group")}isOpened(){return!!this._getPicker()?.open}_handleItemNavigation(e,t){this.selectedItemIndex=t;if(!this._getItems().length){return}if(e){this._selectNextItem()}else{this._selectPreviousItem()}}_selectNextItem(){const e=this._getItems().length;const t=this.selectedItemIndex;if(t!==-1&&t+1>e-1){return}this._moveItemSelection(t,++this.selectedItemIndex)}_selectPreviousItem(){const e=this._getItems();const t=this.selectedItemIndex;if(t===-1||t===null){return}if(t-1<0){if(e[t].hasAttribute("ui5-suggestion-item")||e[t].hasAttribute("ui5-suggestion-item-custom")){e[t].selected=false}e[t].focused=false;this.component.focused=true;this.component.hasSuggestionItemSelected=false;this.selectedItemIndex-=1;return}this._moveItemSelection(t,--this.selectedItemIndex)}_moveItemSelection(e,t){const s=this._getItems();const i=s[t];const n=s[e];const o=this._getNonGroupItems();const r=i.hasAttribute("ui5-suggestion-item-group");if(!i){return}this.component.focused=false;const a=this._getItems()[this.selectedItemIndex];this.accInfo={isGroup:r,currentPos:s.indexOf(i)+1,itemText:(r?a.headerText:a.text)||""};if(i.hasAttribute("ui5-suggestion-item")||i.hasAttribute("ui5-suggestion-item-custom")){this.accInfo.additionalText=i.additionalText||"";this.accInfo.currentPos=o.indexOf(i)+1;this.accInfo.listSize=o.length}if(n){n.focused=false}if(n?.hasAttribute("ui5-suggestion-item")||n?.hasAttribute("ui5-suggestion-item-custom")){n.selected=false}if(i){i.focused=true;if(!r){i.selected=true}if(this.handleFocus){i.focus()}}this.component.hasSuggestionItemSelected=true;this.onItemSelect(i);if(!this._isItemIntoView(i)){const e=this._isGroupItem?i.shadowRoot.querySelector("[ui5-li-group-header]"):i;this._scrollItemIntoView(e)}}_deselectItems(){const e=this._getItems();e.forEach(e=>{if(e.hasAttribute("ui5-suggestion-item")){e.selected=false}e.focused=false})}_clearItemFocus(){const e=this._getItems().find(e=>e.focused);if(e){e.focused=false}}_isItemIntoView(e){const t=e.getDomRef().getBoundingClientRect();const s=this._getComponent().getDomRef().getBoundingClientRect();const i=window.innerHeight||document.documentElement.clientHeight;let n=0;if(this._hasValueState){const e=this._getPicker().querySelector("[slot=header]");n=e.getBoundingClientRect().height}return t.top+V.SCROLL_STEP<=i&&t.top>=s.top+n}_scrollItemIntoView(e){e.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}_getScrollContainer(){if(!this._scrollContainer){this._scrollContainer=this._getPicker().shadowRoot.querySelector(".ui5-popup-content")}return this._scrollContainer}_getItems(){const e=this._getComponent();return e.getSlottedNodes("suggestionItems").flatMap(e=>e.hasAttribute("ui5-suggestion-item-group")?[e,...e.items]:[e])}_getNonGroupItems(){return this._getItems().filter(e=>!e.hasAttribute("ui5-suggestion-item-group"))}_getComponent(){return this.component}_getList(){return this._getPicker().querySelector("[ui5-list]")}_getListWidth(){return this._getList()?.offsetWidth}_getPicker(){return this._getComponent().shadowRoot.querySelector("[ui5-responsive-popover]")}get itemSelectionAnnounce(){if(!this.accInfo){return""}if(this.accInfo.isGroup){return`${V.i18nBundle.getText(u.LIST_ITEM_GROUP_HEADER)} ${this.accInfo.itemText}`}const e=V.i18nBundle.getText(u.LIST_ITEM_POSITION,this.accInfo.currentPos||0,this.accInfo.listSize||0);return`${this.accInfo.additionalText} ${e}`}hightlightInput(e,s){return t.f(e,s)}get _hasValueState(){return this.component.hasValueStateMessage}_clearSelectedSuggestionAndaccInfo(){this.accInfo=undefined;this.selectedItemIndex=0}}V.SCROLL_STEP=60;s.Input.SuggestionsClass=V;e.default=V});
//# sourceMappingURL=InputSuggestions.js.map